/*
 * (C) Copyright 2005- ECMWF.
 *
 * This software is licensed under the terms of the Apache Licence Version 2.0
 * which can be obtained at http://www.apache.org/licenses/LICENSE-2.0.
 *
 * In applying this licence, ECMWF does not waive the privileges and immunities granted to it by
 * virtue of its status as an intergovernmental organisation nor does it submit to any jurisdiction.
 */

/***************************************************************************
 *   Jean Baptiste Filippi - 01.11.2005                                                           *
 *                                                                         *
 ***************************************************************************/
#include "grib_api_internal.h"

#include <math.h>

#define NUMBER(x) (sizeof(x) / sizeof(x[0]))
#define MAXITER 10

#define RAD2DEG 57.29577951308232087684 /* 180 over pi */
#define DEG2RAD 0.01745329251994329576  /* pi over 180 */

#ifndef MAX
#define MAX(a, b) (((a) > (b)) ? (a) : (b))
#endif
#ifndef MIN
#define MIN(a, b) (((a) < (b)) ? (a) : (b))
#endif

#ifndef M_PI
#define M_PI 3.14159265358979323846
#endif


static void gauss_first_guess(long trunc, double* vals)
{
    long i                = 0, numVals;
    static double gvals[] = {
        2.4048255577E0,
        5.5200781103E0,
        8.6537279129E0,
        11.7915344391E0,
        14.9309177086E0,
        18.0710639679E0,
        21.2116366299E0,
        24.3524715308E0,
        27.4934791320E0,
        30.6346064684E0,
        33.7758202136E0,
        36.9170983537E0,
        40.0584257646E0,
        43.1997917132E0,
        46.3411883717E0,
        49.4826098974E0,
        52.6240518411E0,
        55.7655107550E0,
        58.9069839261E0,
        62.0484691902E0,
        65.1899648002E0,
        68.3314693299E0,
        71.4729816036E0,
        74.6145006437E0,
        77.7560256304E0,
        80.8975558711E0,
        84.0390907769E0,
        87.1806298436E0,
        90.3221726372E0,
        93.4637187819E0,
        96.6052679510E0,
        99.7468198587E0,
        102.8883742542E0,
        106.0299309165E0,
        109.1714896498E0,
        112.3130502805E0,
        115.4546126537E0,
        118.5961766309E0,
        121.7377420880E0,
        124.8793089132E0,
        128.0208770059E0,
        131.1624462752E0,
        134.3040166383E0,
        137.4455880203E0,
        140.5871603528E0,
        143.7287335737E0,
        146.8703076258E0,
        150.0118824570E0,
        153.1534580192E0,
        156.2950342685E0,
    };

    numVals = NUMBER(gvals);
    for (i = 0; i < trunc; i++) {
        if (i < numVals)
            vals[i] = gvals[i];
        else
            vals[i] = vals[i - 1] + M_PI;
    }
}

/* Performance: return the precomputed latitudes for N=640 */
static int get_precomputed_latitudes_N640(double* lats)
{
    lats[0]    = 89.892396445590066;
    lats[1]    = 89.753004943174034;
    lats[2]    = 89.612790258599077;
    lats[3]    = 89.472389582061126;
    lats[4]    = 89.331918354381827;
    lats[5]    = 89.191412986832432;
    lats[6]    = 89.050888539966436;
    lats[7]    = 88.91035235926023;
    lats[8]    = 88.76980845110036;
    lats[9]    = 88.629259185411627;
    lats[10]   = 88.488706053376362;
    lats[11]   = 88.348150039999084;
    lats[12]   = 88.207591822004105;
    lats[13]   = 88.067031879650926;
    lats[14]   = 87.926470563186442;
    lats[15]   = 87.785908134040668;
    lats[16]   = 87.645344791295628;
    lats[17]   = 87.504780689222315;
    lats[18]   = 87.364215949214667;
    lats[19]   = 87.223650668104085;
    lats[20]   = 87.083084924070917;
    lats[21]   = 86.942518780928566;
    lats[22]   = 86.801952291278369;
    lats[23]   = 86.661385498868242;
    lats[24]   = 86.520818440379529;
    lats[25]   = 86.380251146798656;
    lats[26]   = 86.239683644481104;
    lats[27]   = 86.0991159559849;
    lats[28]   = 85.958548100730781;
    lats[29]   = 85.817980095529578;
    lats[30]   = 85.677411955006008;
    lats[31]   = 85.536843691942948;
    lats[32]   = 85.396275317562669;
    lats[33]   = 85.255706841757572;
    lats[34]   = 85.115138273281829;
    lats[35]   = 84.974569619910426;
    lats[36]   = 84.834000888572191;
    lats[37]   = 84.693432085462035;
    lats[38]   = 84.552863216135577;
    lats[39]   = 84.412294285589354;
    lats[40]   = 84.271725298329656;
    lats[41]   = 84.131156258431133;
    lats[42]   = 83.990587169587158;
    lats[43]   = 83.850018035153667;
    lats[44]   = 83.709448858186462;
    lats[45]   = 83.568879641474325;
    lats[46]   = 83.428310387567549;
    lats[47]   = 83.287741098802584;
    lats[48]   = 83.147171777324388;
    lats[49]   = 83.006602425105484;
    lats[50]   = 82.866033043962815;
    lats[51]   = 82.725463635573107;
    lats[52]   = 82.584894201485696;
    lats[53]   = 82.444324743134914;
    lats[54]   = 82.303755261850071;
    lats[55]   = 82.163185758865239;
    lats[56]   = 82.022616235327504;
    lats[57]   = 81.882046692304485;
    lats[58]   = 81.741477130791196;
    lats[59]   = 81.600907551715878;
    lats[60]   = 81.460337955945846;
    lats[61]   = 81.319768344292086;
    lats[62]   = 81.179198717514012;
    lats[63]   = 81.038629076323318;
    lats[64]   = 80.898059421387785;
    lats[65]   = 80.757489753334553;
    lats[66]   = 80.616920072753146;
    lats[67]   = 80.47635038019834;
    lats[68]   = 80.335780676192584;
    lats[69]   = 80.195210961228469;
    lats[70]   = 80.054641235770603;
    lats[71]   = 79.914071500257819;
    lats[72]   = 79.773501755104689;
    lats[73]   = 79.632932000703448;
    lats[74]   = 79.492362237425226;
    lats[75]   = 79.351792465621628;
    lats[76]   = 79.211222685625927;
    lats[77]   = 79.070652897754229;
    lats[78]   = 78.930083102306568;
    lats[79]   = 78.789513299567957;
    lats[80]   = 78.648943489809355;
    lats[81]   = 78.508373673288318;
    lats[82]   = 78.367803850250056;
    lats[83]   = 78.227234020928066;
    lats[84]   = 78.086664185544819;
    lats[85]   = 77.946094344312371;
    lats[86]   = 77.805524497433041;
    lats[87]   = 77.664954645099883;
    lats[88]   = 77.524384787497311;
    lats[89]   = 77.383814924801513;
    lats[90]   = 77.243245057180829;
    lats[91]   = 77.102675184796354;
    lats[92]   = 76.962105307802219;
    lats[93]   = 76.821535426345932;
    lats[94]   = 76.680965540568806;
    lats[95]   = 76.540395650606285;
    lats[96]   = 76.399825756588143;
    lats[97]   = 76.259255858638895;
    lats[98]   = 76.118685956877997;
    lats[99]   = 75.978116051420102;
    lats[100]  = 75.837546142375359;
    lats[101]  = 75.69697622984954;
    lats[102]  = 75.556406313944308;
    lats[103]  = 75.41583639475742;
    lats[104]  = 75.275266472382896;
    lats[105]  = 75.134696546911186;
    lats[106]  = 74.994126618429377;
    lats[107]  = 74.853556687021296;
    lats[108]  = 74.712986752767719;
    lats[109]  = 74.57241681574645;
    lats[110]  = 74.431846876032495;
    lats[111]  = 74.291276933698185;
    lats[112]  = 74.150706988813226;
    lats[113]  = 74.010137041445006;
    lats[114]  = 73.869567091658411;
    lats[115]  = 73.728997139516167;
    lats[116]  = 73.588427185078871;
    lats[117]  = 73.447857228405013;
    lats[118]  = 73.307287269551111;
    lats[119]  = 73.166717308571819;
    lats[120]  = 73.026147345520002;
    lats[121]  = 72.885577380446747;
    lats[122]  = 72.745007413401481;
    lats[123]  = 72.604437444432065;
    lats[124]  = 72.463867473584784;
    lats[125]  = 72.323297500904502;
    lats[126]  = 72.182727526434604;
    lats[127]  = 72.042157550217183;
    lats[128]  = 71.901587572292982;
    lats[129]  = 71.761017592701492;
    lats[130]  = 71.620447611481026;
    lats[131]  = 71.47987762866866;
    lats[132]  = 71.339307644300462;
    lats[133]  = 71.198737658411332;
    lats[134]  = 71.058167671035164;
    lats[135]  = 70.917597682204899;
    lats[136]  = 70.777027691952398;
    lats[137]  = 70.636457700308753;
    lats[138]  = 70.495887707304007;
    lats[139]  = 70.355317712967462;
    lats[140]  = 70.214747717327526;
    lats[141]  = 70.074177720411782;
    lats[142]  = 69.933607722247146;
    lats[143]  = 69.793037722859665;
    lats[144]  = 69.65246772227475;
    lats[145]  = 69.511897720517084;
    lats[146]  = 69.37132771761064;
    lats[147]  = 69.230757713578825;
    lats[148]  = 69.090187708444333;
    lats[149]  = 68.949617702229318;
    lats[150]  = 68.809047694955296;
    lats[151]  = 68.668477686643286;
    lats[152]  = 68.52790767731365;
    lats[153]  = 68.387337666986312;
    lats[154]  = 68.246767655680657;
    lats[155]  = 68.106197643415527;
    lats[156]  = 67.965627630209354;
    lats[157]  = 67.825057616080073;
    lats[158]  = 67.684487601045149;
    lats[159]  = 67.543917585121662;
    lats[160]  = 67.403347568326168;
    lats[161]  = 67.262777550674912;
    lats[162]  = 67.122207532183722;
    lats[163]  = 66.981637512867991;
    lats[164]  = 66.841067492742795;
    lats[165]  = 66.700497471822814;
    lats[166]  = 66.559927450122359;
    lats[167]  = 66.41935742765547;
    lats[168]  = 66.278787404435761;
    lats[169]  = 66.138217380476604;
    lats[170]  = 65.997647355791017;
    lats[171]  = 65.85707733039176;
    lats[172]  = 65.716507304291198;
    lats[173]  = 65.575937277501538;
    lats[174]  = 65.435367250034616;
    lats[175]  = 65.294797221902016;
    lats[176]  = 65.154227193115119;
    lats[177]  = 65.013657163684968;
    lats[178]  = 64.873087133622406;
    lats[179]  = 64.732517102938033;
    lats[180]  = 64.591947071642196;
    lats[181]  = 64.451377039745026;
    lats[182]  = 64.310807007256443;
    lats[183]  = 64.170236974186125;
    lats[184]  = 64.029666940543564;
    lats[185]  = 63.889096906338061;
    lats[186]  = 63.748526871578648;
    lats[187]  = 63.607956836274255;
    lats[188]  = 63.467386800433559;
    lats[189]  = 63.326816764065093;
    lats[190]  = 63.186246727177178;
    lats[191]  = 63.045676689778013;
    lats[192]  = 62.905106651875542;
    lats[193]  = 62.764536613477638;
    lats[194]  = 62.62396657459194;
    lats[195]  = 62.483396535225978;
    lats[196]  = 62.342826495387122;
    lats[197]  = 62.202256455082583;
    lats[198]  = 62.061686414319418;
    lats[199]  = 61.921116373104539;
    lats[200]  = 61.780546331444761;
    lats[201]  = 61.639976289346727;
    lats[202]  = 61.499406246816953;
    lats[203]  = 61.358836203861841;
    lats[204]  = 61.21826616048768;
    lats[205]  = 61.077696116700601;
    lats[206]  = 60.937126072506608;
    lats[207]  = 60.796556027911663;
    lats[208]  = 60.655985982921543;
    lats[209]  = 60.515415937541938;
    lats[210]  = 60.374845891778421;
    lats[211]  = 60.234275845636503;
    lats[212]  = 60.093705799121537;
    lats[213]  = 59.953135752238794;
    lats[214]  = 59.812565704993467;
    lats[215]  = 59.671995657390596;
    lats[216]  = 59.531425609435225;
    lats[217]  = 59.390855561132213;
    lats[218]  = 59.250285512486386;
    lats[219]  = 59.10971546350244;
    lats[220]  = 58.96914541418505;
    lats[221]  = 58.828575364538722;
    lats[222]  = 58.688005314567938;
    lats[223]  = 58.547435264277105;
    lats[224]  = 58.406865213670514;
    lats[225]  = 58.266295162752428;
    lats[226]  = 58.125725111526968;
    lats[227]  = 57.985155059998249;
    lats[228]  = 57.844585008170284;
    lats[229]  = 57.704014956047033;
    lats[230]  = 57.563444903632337;
    lats[231]  = 57.422874850930043;
    lats[232]  = 57.282304797943887;
    lats[233]  = 57.141734744677549;
    lats[234]  = 57.001164691134662;
    lats[235]  = 56.860594637318769;
    lats[236]  = 56.720024583233375;
    lats[237]  = 56.579454528881925;
    lats[238]  = 56.438884474267795;
    lats[239]  = 56.29831441939433;
    lats[240]  = 56.157744364264779;
    lats[241]  = 56.017174308882367;
    lats[242]  = 55.876604253250278;
    lats[243]  = 55.736034197371588;
    lats[244]  = 55.595464141249401;
    lats[245]  = 55.45489408488671;
    lats[246]  = 55.314324028286471;
    lats[247]  = 55.173753971451625;
    lats[248]  = 55.033183914385013;
    lats[249]  = 54.892613857089486;
    lats[250]  = 54.752043799567822;
    lats[251]  = 54.611473741822735;
    lats[252]  = 54.470903683856939;
    lats[253]  = 54.330333625673063;
    lats[254]  = 54.189763567273758;
    lats[255]  = 54.049193508661538;
    lats[256]  = 53.90862344983897;
    lats[257]  = 53.768053390808532;
    lats[258]  = 53.627483331572677;
    lats[259]  = 53.486913272133812;
    lats[260]  = 53.346343212494332;
    lats[261]  = 53.205773152656562;
    lats[262]  = 53.065203092622802;
    lats[263]  = 52.924633032395342;
    lats[264]  = 52.784062971976404;
    lats[265]  = 52.643492911368206;
    lats[266]  = 52.502922850572908;
    lats[267]  = 52.362352789592649;
    lats[268]  = 52.221782728429538;
    lats[269]  = 52.081212667085637;
    lats[270]  = 51.940642605563028;
    lats[271]  = 51.800072543863692;
    lats[272]  = 51.659502481989627;
    lats[273]  = 51.518932419942786;
    lats[274]  = 51.378362357725095;
    lats[275]  = 51.237792295338465;
    lats[276]  = 51.097222232784773;
    lats[277]  = 50.956652170065858;
    lats[278]  = 50.81608210718354;
    lats[279]  = 50.675512044139623;
    lats[280]  = 50.534941980935862;
    lats[281]  = 50.39437191757402;
    lats[282]  = 50.253801854055808;
    lats[283]  = 50.113231790382912;
    lats[284]  = 49.972661726557028;
    lats[285]  = 49.832091662579785;
    lats[286]  = 49.691521598452823;
    lats[287]  = 49.550951534177734;
    lats[288]  = 49.410381469756118;
    lats[289]  = 49.269811405189529;
    lats[290]  = 49.129241340479489;
    lats[291]  = 48.988671275627539;
    lats[292]  = 48.848101210635171;
    lats[293]  = 48.707531145503857;
    lats[294]  = 48.56696108023506;
    lats[295]  = 48.42639101483023;
    lats[296]  = 48.285820949290759;
    lats[297]  = 48.145250883618075;
    lats[298]  = 48.004680817813544;
    lats[299]  = 47.864110751878535;
    lats[300]  = 47.723540685814392;
    lats[301]  = 47.582970619622444;
    lats[302]  = 47.442400553303997;
    lats[303]  = 47.301830486860368;
    lats[304]  = 47.161260420292813;
    lats[305]  = 47.020690353602596;
    lats[306]  = 46.880120286790955;
    lats[307]  = 46.73955021985914;
    lats[308]  = 46.598980152808338;
    lats[309]  = 46.458410085639763;
    lats[310]  = 46.317840018354602;
    lats[311]  = 46.177269950954006;
    lats[312]  = 46.036699883439134;
    lats[313]  = 45.896129815811136;
    lats[314]  = 45.755559748071114;
    lats[315]  = 45.614989680220205;
    lats[316]  = 45.474419612259481;
    lats[317]  = 45.333849544190024;
    lats[318]  = 45.193279476012933;
    lats[319]  = 45.052709407729239;
    lats[320]  = 44.912139339339987;
    lats[321]  = 44.771569270846214;
    lats[322]  = 44.630999202248923;
    lats[323]  = 44.490429133549149;
    lats[324]  = 44.349859064747854;
    lats[325]  = 44.209288995846045;
    lats[326]  = 44.068718926844674;
    lats[327]  = 43.928148857744716;
    lats[328]  = 43.787578788547094;
    lats[329]  = 43.64700871925276;
    lats[330]  = 43.506438649862638;
    lats[331]  = 43.365868580377636;
    lats[332]  = 43.225298510798666;
    lats[333]  = 43.0847284411266;
    lats[334]  = 42.944158371362349;
    lats[335]  = 42.803588301506764;
    lats[336]  = 42.663018231560706;
    lats[337]  = 42.522448161525034;
    lats[338]  = 42.381878091400594;
    lats[339]  = 42.241308021188203;
    lats[340]  = 42.100737950888686;
    lats[341]  = 41.960167880502873;
    lats[342]  = 41.819597810031553;
    lats[343]  = 41.679027739475522;
    lats[344]  = 41.538457668835562;
    lats[345]  = 41.397887598112455;
    lats[346]  = 41.257317527306981;
    lats[347]  = 41.116747456419873;
    lats[348]  = 40.976177385451912;
    lats[349]  = 40.835607314403816;
    lats[350]  = 40.695037243276325;
    lats[351]  = 40.554467172070169;
    lats[352]  = 40.41389710078608;
    lats[353]  = 40.273327029424742;
    lats[354]  = 40.132756957986885;
    lats[355]  = 39.992186886473185;
    lats[356]  = 39.851616814884331;
    lats[357]  = 39.711046743220997;
    lats[358]  = 39.570476671483874;
    lats[359]  = 39.429906599673615;
    lats[360]  = 39.289336527790894;
    lats[361]  = 39.148766455836338;
    lats[362]  = 39.008196383810613;
    lats[363]  = 38.867626311714339;
    lats[364]  = 38.727056239548169;
    lats[365]  = 38.5864861673127;
    lats[366]  = 38.44591609500857;
    lats[367]  = 38.305346022636385;
    lats[368]  = 38.164775950196741;
    lats[369]  = 38.02420587769025;
    lats[370]  = 37.883635805117493;
    lats[371]  = 37.743065732479067;
    lats[372]  = 37.602495659775542;
    lats[373]  = 37.461925587007492;
    lats[374]  = 37.321355514175501;
    lats[375]  = 37.180785441280122;
    lats[376]  = 37.040215368321896;
    lats[377]  = 36.899645295301404;
    lats[378]  = 36.759075222219167;
    lats[379]  = 36.618505149075737;
    lats[380]  = 36.477935075871656;
    lats[381]  = 36.33736500260742;
    lats[382]  = 36.196794929283605;
    lats[383]  = 36.056224855900687;
    lats[384]  = 35.9156547824592;
    lats[385]  = 35.775084708959632;
    lats[386]  = 35.634514635402525;
    lats[387]  = 35.493944561788332;
    lats[388]  = 35.353374488117588;
    lats[389]  = 35.21280441439076;
    lats[390]  = 35.072234340608333;
    lats[391]  = 34.931664266770788;
    lats[392]  = 34.79109419287861;
    lats[393]  = 34.650524118932253;
    lats[394]  = 34.509954044932208;
    lats[395]  = 34.369383970878907;
    lats[396]  = 34.228813896772813;
    lats[397]  = 34.088243822614395;
    lats[398]  = 33.9476737484041;
    lats[399]  = 33.807103674142361;
    lats[400]  = 33.66653359982962;
    lats[401]  = 33.525963525466317;
    lats[402]  = 33.385393451052892;
    lats[403]  = 33.244823376589757;
    lats[404]  = 33.104253302077339;
    lats[405]  = 32.963683227516071;
    lats[406]  = 32.823113152906366;
    lats[407]  = 32.682543078248621;
    lats[408]  = 32.541973003543255;
    lats[409]  = 32.401402928790681;
    lats[410]  = 32.260832853991289;
    lats[411]  = 32.120262779145477;
    lats[412]  = 31.979692704253651;
    lats[413]  = 31.839122629316183;
    lats[414]  = 31.698552554333489;
    lats[415]  = 31.55798247930592;
    lats[416]  = 31.417412404233875;
    lats[417]  = 31.276842329117731;
    lats[418]  = 31.136272253957859;
    lats[419]  = 30.99570217875463;
    lats[420]  = 30.855132103508407;
    lats[421]  = 30.71456202821955;
    lats[422]  = 30.573991952888438;
    lats[423]  = 30.433421877515418;
    lats[424]  = 30.292851802100841;
    lats[425]  = 30.152281726645064;
    lats[426]  = 30.011711651148435;
    lats[427]  = 29.87114157561129;
    lats[428]  = 29.730571500033992;
    lats[429]  = 29.590001424416862;
    lats[430]  = 29.449431348760253;
    lats[431]  = 29.308861273064483;
    lats[432]  = 29.168291197329893;
    lats[433]  = 29.027721121556816;
    lats[434]  = 28.887151045745565;
    lats[435]  = 28.746580969896474;
    lats[436]  = 28.606010894009859;
    lats[437]  = 28.465440818086037;
    lats[438]  = 28.324870742125327;
    lats[439]  = 28.184300666128038;
    lats[440]  = 28.043730590094491;
    lats[441]  = 27.903160514024975;
    lats[442]  = 27.762590437919812;
    lats[443]  = 27.622020361779295;
    lats[444]  = 27.481450285603731;
    lats[445]  = 27.340880209393415;
    lats[446]  = 27.200310133148644;
    lats[447]  = 27.05974005686971;
    lats[448]  = 26.919169980556905;
    lats[449]  = 26.778599904210516;
    lats[450]  = 26.638029827830831;
    lats[451]  = 26.497459751418134;
    lats[452]  = 26.356889674972713;
    lats[453]  = 26.216319598494842;
    lats[454]  = 26.075749521984797;
    lats[455]  = 25.935179445442859;
    lats[456]  = 25.794609368869299;
    lats[457]  = 25.654039292264386;
    lats[458]  = 25.513469215628398;
    lats[459]  = 25.3728991389616;
    lats[460]  = 25.232329062264245;
    lats[461]  = 25.091758985536615;
    lats[462]  = 24.951188908778963;
    lats[463]  = 24.810618831991551;
    lats[464]  = 24.670048755174633;
    lats[465]  = 24.529478678328466;
    lats[466]  = 24.388908601453309;
    lats[467]  = 24.248338524549407;
    lats[468]  = 24.107768447617016;
    lats[469]  = 23.96719837065638;
    lats[470]  = 23.826628293667756;
    lats[471]  = 23.686058216651375;
    lats[472]  = 23.545488139607492;
    lats[473]  = 23.404918062536346;
    lats[474]  = 23.264347985438178;
    lats[475]  = 23.123777908313219;
    lats[476]  = 22.98320783116171;
    lats[477]  = 22.84263775398389;
    lats[478]  = 22.70206767677999;
    lats[479]  = 22.561497599550243;
    lats[480]  = 22.420927522294875;
    lats[481]  = 22.280357445014126;
    lats[482]  = 22.139787367708202;
    lats[483]  = 21.999217290377352;
    lats[484]  = 21.858647213021786;
    lats[485]  = 21.718077135641735;
    lats[486]  = 21.577507058237412;
    lats[487]  = 21.436936980809044;
    lats[488]  = 21.296366903356844;
    lats[489]  = 21.155796825881037;
    lats[490]  = 21.015226748381831;
    lats[491]  = 20.874656670859444;
    lats[492]  = 20.734086593314085;
    lats[493]  = 20.593516515745968;
    lats[494]  = 20.452946438155308;
    lats[495]  = 20.312376360542309;
    lats[496]  = 20.171806282907177;
    lats[497]  = 20.031236205250121;
    lats[498]  = 19.890666127571347;
    lats[499]  = 19.750096049871054;
    lats[500]  = 19.609525972149449;
    lats[501]  = 19.468955894406733;
    lats[502]  = 19.328385816643106;
    lats[503]  = 19.187815738858767;
    lats[504]  = 19.04724566105391;
    lats[505]  = 18.906675583228736;
    lats[506]  = 18.766105505383443;
    lats[507]  = 18.625535427518219;
    lats[508]  = 18.484965349633256;
    lats[509]  = 18.344395271728757;
    lats[510]  = 18.203825193804899;
    lats[511]  = 18.063255115861882;
    lats[512]  = 17.922685037899889;
    lats[513]  = 17.782114959919113;
    lats[514]  = 17.641544881919739;
    lats[515]  = 17.500974803901951;
    lats[516]  = 17.360404725865926;
    lats[517]  = 17.219834647811862;
    lats[518]  = 17.079264569739937;
    lats[519]  = 16.938694491650331;
    lats[520]  = 16.798124413543224;
    lats[521]  = 16.657554335418794;
    lats[522]  = 16.516984257277226;
    lats[523]  = 16.376414179118694;
    lats[524]  = 16.235844100943371;
    lats[525]  = 16.09527402275144;
    lats[526]  = 15.954703944543072;
    lats[527]  = 15.814133866318445;
    lats[528]  = 15.673563788077727;
    lats[529]  = 15.532993709821094;
    lats[530]  = 15.392423631548718;
    lats[531]  = 15.251853553260768;
    lats[532]  = 15.111283474957411;
    lats[533]  = 14.970713396638821;
    lats[534]  = 14.830143318305167;
    lats[535]  = 14.689573239956617;
    lats[536]  = 14.549003161593328;
    lats[537]  = 14.408433083215476;
    lats[538]  = 14.267863004823225;
    lats[539]  = 14.127292926416734;
    lats[540]  = 13.986722847996173;
    lats[541]  = 13.8461527695617;
    lats[542]  = 13.705582691113481;
    lats[543]  = 13.565012612651675;
    lats[544]  = 13.424442534176441;
    lats[545]  = 13.283872455687943;
    lats[546]  = 13.143302377186339;
    lats[547]  = 13.002732298671786;
    lats[548]  = 12.862162220144443;
    lats[549]  = 12.72159214160447;
    lats[550]  = 12.58102206305202;
    lats[551]  = 12.440451984487247;
    lats[552]  = 12.299881905910311;
    lats[553]  = 12.159311827321366;
    lats[554]  = 12.018741748720567;
    lats[555]  = 11.878171670108063;
    lats[556]  = 11.73760159148401;
    lats[557]  = 11.597031512848561;
    lats[558]  = 11.456461434201868;
    lats[559]  = 11.315891355544077;
    lats[560]  = 11.175321276875344;
    lats[561]  = 11.034751198195819;
    lats[562]  = 10.894181119505649;
    lats[563]  = 10.753611040804984;
    lats[564]  = 10.613040962093971;
    lats[565]  = 10.472470883372759;
    lats[566]  = 10.331900804641496;
    lats[567]  = 10.191330725900327;
    lats[568]  = 10.050760647149401;
    lats[569]  = 9.9101905683888614;
    lats[570]  = 9.7696204896188554;
    lats[571]  = 9.6290504108395272;
    lats[572]  = 9.4884803320510205;
    lats[573]  = 9.3479102532534792;
    lats[574]  = 9.2073401744470491;
    lats[575]  = 9.0667700956318686;
    lats[576]  = 8.9262000168080871;
    lats[577]  = 8.7856299379758411;
    lats[578]  = 8.645059859135273;
    lats[579]  = 8.5044897802865282;
    lats[580]  = 8.3639197014297419;
    lats[581]  = 8.223349622565058;
    lats[582]  = 8.0827795436926184;
    lats[583]  = 7.9422094648125583;
    lats[584]  = 7.8016393859250206;
    lats[585]  = 7.661069307030143;
    lats[586]  = 7.5204992281280649;
    lats[587]  = 7.3799291492189223;
    lats[588]  = 7.2393590703028563;
    lats[589]  = 7.098788991380002;
    lats[590]  = 6.9582189124504987;
    lats[591]  = 6.8176488335144816;
    lats[592]  = 6.6770787545720891;
    lats[593]  = 6.5365086756234554;
    lats[594]  = 6.3959385966687181;
    lats[595]  = 6.2553685177080123;
    lats[596]  = 6.1147984387414738;
    lats[597]  = 5.9742283597692367;
    lats[598]  = 5.833658280791437;
    lats[599]  = 5.6930882018082087;
    lats[600]  = 5.5525181228196869;
    lats[601]  = 5.4119480438260039;
    lats[602]  = 5.2713779648272956;
    lats[603]  = 5.1308078858236934;
    lats[604]  = 4.9902378068153324;
    lats[605]  = 4.8496677278023448;
    lats[606]  = 4.7090976487848639;
    lats[607]  = 4.5685275697630221;
    lats[608]  = 4.4279574907369508;
    lats[609]  = 4.2873874117067841;
    lats[610]  = 4.1468173326726534;
    lats[611]  = 4.0062472536346903;
    lats[612]  = 3.8656771745930261;
    lats[613]  = 3.7251070955477918;
    lats[614]  = 3.5845370164991213;
    lats[615]  = 3.4439669374471427;
    lats[616]  = 3.3033968583919884;
    lats[617]  = 3.1628267793337885;
    lats[618]  = 3.0222567002726746;
    lats[619]  = 2.8816866212087762;
    lats[620]  = 2.7411165421422243;
    lats[621]  = 2.6005464630731496;
    lats[622]  = 2.4599763840016813;
    lats[623]  = 2.3194063049279499;
    lats[624]  = 2.1788362258520855;
    lats[625]  = 2.0382661467742174;
    lats[626]  = 1.8976960676944756;
    lats[627]  = 1.7571259886129893;
    lats[628]  = 1.6165559095298885;
    lats[629]  = 1.4759858304453026;
    lats[630]  = 1.3354157513593612;
    lats[631]  = 1.194845672272193;
    lats[632]  = 1.0542755931839276;
    lats[633]  = 0.91370551409469447;
    lats[634]  = 0.77313543500462234;
    lats[635]  = 0.63256535591384055;
    lats[636]  = 0.49199527682247807;
    lats[637]  = 0.351425197730664;
    lats[638]  = 0.21085511863852741;
    lats[639]  = 0.070285039546197275;
    lats[640]  = -0.070285039546197275;
    lats[641]  = -0.21085511863852741;
    lats[642]  = -0.351425197730664;
    lats[643]  = -0.49199527682247807;
    lats[644]  = -0.63256535591384055;
    lats[645]  = -0.77313543500462234;
    lats[646]  = -0.91370551409469447;
    lats[647]  = -1.0542755931839276;
    lats[648]  = -1.194845672272193;
    lats[649]  = -1.3354157513593612;
    lats[650]  = -1.4759858304453026;
    lats[651]  = -1.6165559095298885;
    lats[652]  = -1.7571259886129893;
    lats[653]  = -1.8976960676944756;
    lats[654]  = -2.0382661467742174;
    lats[655]  = -2.1788362258520855;
    lats[656]  = -2.3194063049279499;
    lats[657]  = -2.4599763840016813;
    lats[658]  = -2.6005464630731496;
    lats[659]  = -2.7411165421422243;
    lats[660]  = -2.8816866212087762;
    lats[661]  = -3.0222567002726746;
    lats[662]  = -3.1628267793337885;
    lats[663]  = -3.3033968583919884;
    lats[664]  = -3.4439669374471427;
    lats[665]  = -3.5845370164991213;
    lats[666]  = -3.7251070955477918;
    lats[667]  = -3.8656771745930261;
    lats[668]  = -4.0062472536346903;
    lats[669]  = -4.1468173326726534;
    lats[670]  = -4.2873874117067841;
    lats[671]  = -4.4279574907369508;
    lats[672]  = -4.5685275697630221;
    lats[673]  = -4.7090976487848639;
    lats[674]  = -4.8496677278023448;
    lats[675]  = -4.9902378068153324;
    lats[676]  = -5.1308078858236934;
    lats[677]  = -5.2713779648272956;
    lats[678]  = -5.4119480438260039;
    lats[679]  = -5.5525181228196869;
    lats[680]  = -5.6930882018082087;
    lats[681]  = -5.833658280791437;
    lats[682]  = -5.9742283597692367;
    lats[683]  = -6.1147984387414738;
    lats[684]  = -6.2553685177080123;
    lats[685]  = -6.3959385966687181;
    lats[686]  = -6.5365086756234554;
    lats[687]  = -6.6770787545720891;
    lats[688]  = -6.8176488335144816;
    lats[689]  = -6.9582189124504987;
    lats[690]  = -7.098788991380002;
    lats[691]  = -7.2393590703028563;
    lats[692]  = -7.3799291492189223;
    lats[693]  = -7.5204992281280649;
    lats[694]  = -7.661069307030143;
    lats[695]  = -7.8016393859250206;
    lats[696]  = -7.9422094648125583;
    lats[697]  = -8.0827795436926184;
    lats[698]  = -8.223349622565058;
    lats[699]  = -8.3639197014297419;
    lats[700]  = -8.5044897802865282;
    lats[701]  = -8.645059859135273;
    lats[702]  = -8.7856299379758411;
    lats[703]  = -8.9262000168080871;
    lats[704]  = -9.0667700956318686;
    lats[705]  = -9.2073401744470491;
    lats[706]  = -9.3479102532534792;
    lats[707]  = -9.4884803320510205;
    lats[708]  = -9.6290504108395272;
    lats[709]  = -9.7696204896188554;
    lats[710]  = -9.9101905683888614;
    lats[711]  = -10.050760647149401;
    lats[712]  = -10.191330725900327;
    lats[713]  = -10.331900804641496;
    lats[714]  = -10.472470883372759;
    lats[715]  = -10.613040962093971;
    lats[716]  = -10.753611040804984;
    lats[717]  = -10.894181119505649;
    lats[718]  = -11.034751198195819;
    lats[719]  = -11.175321276875344;
    lats[720]  = -11.315891355544077;
    lats[721]  = -11.456461434201868;
    lats[722]  = -11.597031512848561;
    lats[723]  = -11.73760159148401;
    lats[724]  = -11.878171670108063;
    lats[725]  = -12.018741748720567;
    lats[726]  = -12.159311827321366;
    lats[727]  = -12.299881905910311;
    lats[728]  = -12.440451984487247;
    lats[729]  = -12.58102206305202;
    lats[730]  = -12.72159214160447;
    lats[731]  = -12.862162220144443;
    lats[732]  = -13.002732298671786;
    lats[733]  = -13.143302377186339;
    lats[734]  = -13.283872455687943;
    lats[735]  = -13.424442534176441;
    lats[736]  = -13.565012612651675;
    lats[737]  = -13.705582691113481;
    lats[738]  = -13.8461527695617;
    lats[739]  = -13.986722847996173;
    lats[740]  = -14.127292926416734;
    lats[741]  = -14.267863004823225;
    lats[742]  = -14.408433083215476;
    lats[743]  = -14.549003161593328;
    lats[744]  = -14.689573239956617;
    lats[745]  = -14.830143318305167;
    lats[746]  = -14.970713396638821;
    lats[747]  = -15.111283474957411;
    lats[748]  = -15.251853553260768;
    lats[749]  = -15.392423631548718;
    lats[750]  = -15.532993709821094;
    lats[751]  = -15.673563788077727;
    lats[752]  = -15.814133866318445;
    lats[753]  = -15.954703944543072;
    lats[754]  = -16.09527402275144;
    lats[755]  = -16.235844100943371;
    lats[756]  = -16.376414179118694;
    lats[757]  = -16.516984257277226;
    lats[758]  = -16.657554335418794;
    lats[759]  = -16.798124413543224;
    lats[760]  = -16.938694491650331;
    lats[761]  = -17.079264569739937;
    lats[762]  = -17.219834647811862;
    lats[763]  = -17.360404725865926;
    lats[764]  = -17.500974803901951;
    lats[765]  = -17.641544881919739;
    lats[766]  = -17.782114959919113;
    lats[767]  = -17.922685037899889;
    lats[768]  = -18.063255115861882;
    lats[769]  = -18.203825193804899;
    lats[770]  = -18.344395271728757;
    lats[771]  = -18.484965349633256;
    lats[772]  = -18.625535427518219;
    lats[773]  = -18.766105505383443;
    lats[774]  = -18.906675583228736;
    lats[775]  = -19.04724566105391;
    lats[776]  = -19.187815738858767;
    lats[777]  = -19.328385816643106;
    lats[778]  = -19.468955894406733;
    lats[779]  = -19.609525972149449;
    lats[780]  = -19.750096049871054;
    lats[781]  = -19.890666127571347;
    lats[782]  = -20.031236205250121;
    lats[783]  = -20.171806282907177;
    lats[784]  = -20.312376360542309;
    lats[785]  = -20.452946438155308;
    lats[786]  = -20.593516515745968;
    lats[787]  = -20.734086593314085;
    lats[788]  = -20.874656670859444;
    lats[789]  = -21.015226748381831;
    lats[790]  = -21.155796825881037;
    lats[791]  = -21.296366903356844;
    lats[792]  = -21.436936980809044;
    lats[793]  = -21.577507058237412;
    lats[794]  = -21.718077135641735;
    lats[795]  = -21.858647213021786;
    lats[796]  = -21.999217290377352;
    lats[797]  = -22.139787367708202;
    lats[798]  = -22.280357445014126;
    lats[799]  = -22.420927522294875;
    lats[800]  = -22.561497599550243;
    lats[801]  = -22.70206767677999;
    lats[802]  = -22.84263775398389;
    lats[803]  = -22.98320783116171;
    lats[804]  = -23.123777908313219;
    lats[805]  = -23.264347985438178;
    lats[806]  = -23.404918062536346;
    lats[807]  = -23.545488139607492;
    lats[808]  = -23.686058216651375;
    lats[809]  = -23.826628293667756;
    lats[810]  = -23.96719837065638;
    lats[811]  = -24.107768447617016;
    lats[812]  = -24.248338524549407;
    lats[813]  = -24.388908601453309;
    lats[814]  = -24.529478678328466;
    lats[815]  = -24.670048755174633;
    lats[816]  = -24.810618831991551;
    lats[817]  = -24.951188908778963;
    lats[818]  = -25.091758985536615;
    lats[819]  = -25.232329062264245;
    lats[820]  = -25.3728991389616;
    lats[821]  = -25.513469215628398;
    lats[822]  = -25.654039292264386;
    lats[823]  = -25.794609368869299;
    lats[824]  = -25.935179445442859;
    lats[825]  = -26.075749521984797;
    lats[826]  = -26.216319598494842;
    lats[827]  = -26.356889674972713;
    lats[828]  = -26.497459751418134;
    lats[829]  = -26.638029827830831;
    lats[830]  = -26.778599904210516;
    lats[831]  = -26.919169980556905;
    lats[832]  = -27.05974005686971;
    lats[833]  = -27.200310133148644;
    lats[834]  = -27.340880209393415;
    lats[835]  = -27.481450285603731;
    lats[836]  = -27.622020361779295;
    lats[837]  = -27.762590437919812;
    lats[838]  = -27.903160514024975;
    lats[839]  = -28.043730590094491;
    lats[840]  = -28.184300666128038;
    lats[841]  = -28.324870742125327;
    lats[842]  = -28.465440818086037;
    lats[843]  = -28.606010894009859;
    lats[844]  = -28.746580969896474;
    lats[845]  = -28.887151045745565;
    lats[846]  = -29.027721121556816;
    lats[847]  = -29.168291197329893;
    lats[848]  = -29.308861273064483;
    lats[849]  = -29.449431348760253;
    lats[850]  = -29.590001424416862;
    lats[851]  = -29.730571500033992;
    lats[852]  = -29.87114157561129;
    lats[853]  = -30.011711651148435;
    lats[854]  = -30.152281726645064;
    lats[855]  = -30.292851802100841;
    lats[856]  = -30.433421877515418;
    lats[857]  = -30.573991952888438;
    lats[858]  = -30.71456202821955;
    lats[859]  = -30.855132103508407;
    lats[860]  = -30.99570217875463;
    lats[861]  = -31.136272253957859;
    lats[862]  = -31.276842329117731;
    lats[863]  = -31.417412404233875;
    lats[864]  = -31.55798247930592;
    lats[865]  = -31.698552554333489;
    lats[866]  = -31.839122629316183;
    lats[867]  = -31.979692704253651;
    lats[868]  = -32.120262779145477;
    lats[869]  = -32.260832853991289;
    lats[870]  = -32.401402928790681;
    lats[871]  = -32.541973003543255;
    lats[872]  = -32.682543078248621;
    lats[873]  = -32.823113152906366;
    lats[874]  = -32.963683227516071;
    lats[875]  = -33.104253302077339;
    lats[876]  = -33.244823376589757;
    lats[877]  = -33.385393451052892;
    lats[878]  = -33.525963525466317;
    lats[879]  = -33.66653359982962;
    lats[880]  = -33.807103674142361;
    lats[881]  = -33.9476737484041;
    lats[882]  = -34.088243822614395;
    lats[883]  = -34.228813896772813;
    lats[884]  = -34.369383970878907;
    lats[885]  = -34.509954044932208;
    lats[886]  = -34.650524118932253;
    lats[887]  = -34.79109419287861;
    lats[888]  = -34.931664266770788;
    lats[889]  = -35.072234340608333;
    lats[890]  = -35.21280441439076;
    lats[891]  = -35.353374488117588;
    lats[892]  = -35.493944561788332;
    lats[893]  = -35.634514635402525;
    lats[894]  = -35.775084708959632;
    lats[895]  = -35.9156547824592;
    lats[896]  = -36.056224855900687;
    lats[897]  = -36.196794929283605;
    lats[898]  = -36.33736500260742;
    lats[899]  = -36.477935075871656;
    lats[900]  = -36.618505149075737;
    lats[901]  = -36.759075222219167;
    lats[902]  = -36.899645295301404;
    lats[903]  = -37.040215368321896;
    lats[904]  = -37.180785441280122;
    lats[905]  = -37.321355514175501;
    lats[906]  = -37.461925587007492;
    lats[907]  = -37.602495659775542;
    lats[908]  = -37.743065732479067;
    lats[909]  = -37.883635805117493;
    lats[910]  = -38.02420587769025;
    lats[911]  = -38.164775950196741;
    lats[912]  = -38.305346022636385;
    lats[913]  = -38.44591609500857;
    lats[914]  = -38.5864861673127;
    lats[915]  = -38.727056239548169;
    lats[916]  = -38.867626311714339;
    lats[917]  = -39.008196383810613;
    lats[918]  = -39.148766455836338;
    lats[919]  = -39.289336527790894;
    lats[920]  = -39.429906599673615;
    lats[921]  = -39.570476671483874;
    lats[922]  = -39.711046743220997;
    lats[923]  = -39.851616814884331;
    lats[924]  = -39.992186886473185;
    lats[925]  = -40.132756957986885;
    lats[926]  = -40.273327029424742;
    lats[927]  = -40.41389710078608;
    lats[928]  = -40.554467172070169;
    lats[929]  = -40.695037243276325;
    lats[930]  = -40.835607314403816;
    lats[931]  = -40.976177385451912;
    lats[932]  = -41.116747456419873;
    lats[933]  = -41.257317527306981;
    lats[934]  = -41.397887598112455;
    lats[935]  = -41.538457668835562;
    lats[936]  = -41.679027739475522;
    lats[937]  = -41.819597810031553;
    lats[938]  = -41.960167880502873;
    lats[939]  = -42.100737950888686;
    lats[940]  = -42.241308021188203;
    lats[941]  = -42.381878091400594;
    lats[942]  = -42.522448161525034;
    lats[943]  = -42.663018231560706;
    lats[944]  = -42.803588301506764;
    lats[945]  = -42.944158371362349;
    lats[946]  = -43.0847284411266;
    lats[947]  = -43.225298510798666;
    lats[948]  = -43.365868580377636;
    lats[949]  = -43.506438649862638;
    lats[950]  = -43.64700871925276;
    lats[951]  = -43.787578788547094;
    lats[952]  = -43.928148857744716;
    lats[953]  = -44.068718926844674;
    lats[954]  = -44.209288995846045;
    lats[955]  = -44.349859064747854;
    lats[956]  = -44.490429133549149;
    lats[957]  = -44.630999202248923;
    lats[958]  = -44.771569270846214;
    lats[959]  = -44.912139339339987;
    lats[960]  = -45.052709407729239;
    lats[961]  = -45.193279476012933;
    lats[962]  = -45.333849544190024;
    lats[963]  = -45.474419612259481;
    lats[964]  = -45.614989680220205;
    lats[965]  = -45.755559748071114;
    lats[966]  = -45.896129815811136;
    lats[967]  = -46.036699883439134;
    lats[968]  = -46.177269950954006;
    lats[969]  = -46.317840018354602;
    lats[970]  = -46.458410085639763;
    lats[971]  = -46.598980152808338;
    lats[972]  = -46.73955021985914;
    lats[973]  = -46.880120286790955;
    lats[974]  = -47.020690353602596;
    lats[975]  = -47.161260420292813;
    lats[976]  = -47.301830486860368;
    lats[977]  = -47.442400553303997;
    lats[978]  = -47.582970619622444;
    lats[979]  = -47.723540685814392;
    lats[980]  = -47.864110751878535;
    lats[981]  = -48.004680817813544;
    lats[982]  = -48.145250883618075;
    lats[983]  = -48.285820949290759;
    lats[984]  = -48.42639101483023;
    lats[985]  = -48.56696108023506;
    lats[986]  = -48.707531145503857;
    lats[987]  = -48.848101210635171;
    lats[988]  = -48.988671275627539;
    lats[989]  = -49.129241340479489;
    lats[990]  = -49.269811405189529;
    lats[991]  = -49.410381469756118;
    lats[992]  = -49.550951534177734;
    lats[993]  = -49.691521598452823;
    lats[994]  = -49.832091662579785;
    lats[995]  = -49.972661726557028;
    lats[996]  = -50.113231790382912;
    lats[997]  = -50.253801854055808;
    lats[998]  = -50.39437191757402;
    lats[999]  = -50.534941980935862;
    lats[1000] = -50.675512044139623;
    lats[1001] = -50.81608210718354;
    lats[1002] = -50.956652170065858;
    lats[1003] = -51.097222232784773;
    lats[1004] = -51.237792295338465;
    lats[1005] = -51.378362357725095;
    lats[1006] = -51.518932419942786;
    lats[1007] = -51.659502481989627;
    lats[1008] = -51.800072543863692;
    lats[1009] = -51.940642605563028;
    lats[1010] = -52.081212667085637;
    lats[1011] = -52.221782728429538;
    lats[1012] = -52.362352789592649;
    lats[1013] = -52.502922850572908;
    lats[1014] = -52.643492911368206;
    lats[1015] = -52.784062971976404;
    lats[1016] = -52.924633032395342;
    lats[1017] = -53.065203092622802;
    lats[1018] = -53.205773152656562;
    lats[1019] = -53.346343212494332;
    lats[1020] = -53.486913272133812;
    lats[1021] = -53.627483331572677;
    lats[1022] = -53.768053390808532;
    lats[1023] = -53.90862344983897;
    lats[1024] = -54.049193508661538;
    lats[1025] = -54.189763567273758;
    lats[1026] = -54.330333625673063;
    lats[1027] = -54.470903683856939;
    lats[1028] = -54.611473741822735;
    lats[1029] = -54.752043799567822;
    lats[1030] = -54.892613857089486;
    lats[1031] = -55.033183914385013;
    lats[1032] = -55.173753971451625;
    lats[1033] = -55.314324028286471;
    lats[1034] = -55.45489408488671;
    lats[1035] = -55.595464141249401;
    lats[1036] = -55.736034197371588;
    lats[1037] = -55.876604253250278;
    lats[1038] = -56.017174308882367;
    lats[1039] = -56.157744364264779;
    lats[1040] = -56.29831441939433;
    lats[1041] = -56.438884474267795;
    lats[1042] = -56.579454528881925;
    lats[1043] = -56.720024583233375;
    lats[1044] = -56.860594637318769;
    lats[1045] = -57.001164691134662;
    lats[1046] = -57.141734744677549;
    lats[1047] = -57.282304797943887;
    lats[1048] = -57.422874850930043;
    lats[1049] = -57.563444903632337;
    lats[1050] = -57.704014956047033;
    lats[1051] = -57.844585008170284;
    lats[1052] = -57.985155059998249;
    lats[1053] = -58.125725111526968;
    lats[1054] = -58.266295162752428;
    lats[1055] = -58.406865213670514;
    lats[1056] = -58.547435264277105;
    lats[1057] = -58.688005314567938;
    lats[1058] = -58.828575364538722;
    lats[1059] = -58.96914541418505;
    lats[1060] = -59.10971546350244;
    lats[1061] = -59.250285512486386;
    lats[1062] = -59.390855561132213;
    lats[1063] = -59.531425609435225;
    lats[1064] = -59.671995657390596;
    lats[1065] = -59.812565704993467;
    lats[1066] = -59.953135752238794;
    lats[1067] = -60.093705799121537;
    lats[1068] = -60.234275845636503;
    lats[1069] = -60.374845891778421;
    lats[1070] = -60.515415937541938;
    lats[1071] = -60.655985982921543;
    lats[1072] = -60.796556027911663;
    lats[1073] = -60.937126072506608;
    lats[1074] = -61.077696116700601;
    lats[1075] = -61.21826616048768;
    lats[1076] = -61.358836203861841;
    lats[1077] = -61.499406246816953;
    lats[1078] = -61.639976289346727;
    lats[1079] = -61.780546331444761;
    lats[1080] = -61.921116373104539;
    lats[1081] = -62.061686414319418;
    lats[1082] = -62.202256455082583;
    lats[1083] = -62.342826495387122;
    lats[1084] = -62.483396535225978;
    lats[1085] = -62.62396657459194;
    lats[1086] = -62.764536613477638;
    lats[1087] = -62.905106651875542;
    lats[1088] = -63.045676689778013;
    lats[1089] = -63.186246727177178;
    lats[1090] = -63.326816764065093;
    lats[1091] = -63.467386800433559;
    lats[1092] = -63.607956836274255;
    lats[1093] = -63.748526871578648;
    lats[1094] = -63.889096906338061;
    lats[1095] = -64.029666940543564;
    lats[1096] = -64.170236974186125;
    lats[1097] = -64.310807007256443;
    lats[1098] = -64.451377039745026;
    lats[1099] = -64.591947071642196;
    lats[1100] = -64.732517102938033;
    lats[1101] = -64.873087133622406;
    lats[1102] = -65.013657163684968;
    lats[1103] = -65.154227193115119;
    lats[1104] = -65.294797221902016;
    lats[1105] = -65.435367250034616;
    lats[1106] = -65.575937277501538;
    lats[1107] = -65.716507304291198;
    lats[1108] = -65.85707733039176;
    lats[1109] = -65.997647355791017;
    lats[1110] = -66.138217380476604;
    lats[1111] = -66.278787404435761;
    lats[1112] = -66.41935742765547;
    lats[1113] = -66.559927450122359;
    lats[1114] = -66.700497471822814;
    lats[1115] = -66.841067492742795;
    lats[1116] = -66.981637512867991;
    lats[1117] = -67.122207532183722;
    lats[1118] = -67.262777550674912;
    lats[1119] = -67.403347568326168;
    lats[1120] = -67.543917585121662;
    lats[1121] = -67.684487601045149;
    lats[1122] = -67.825057616080073;
    lats[1123] = -67.965627630209354;
    lats[1124] = -68.106197643415527;
    lats[1125] = -68.246767655680657;
    lats[1126] = -68.387337666986312;
    lats[1127] = -68.52790767731365;
    lats[1128] = -68.668477686643286;
    lats[1129] = -68.809047694955296;
    lats[1130] = -68.949617702229318;
    lats[1131] = -69.090187708444333;
    lats[1132] = -69.230757713578825;
    lats[1133] = -69.37132771761064;
    lats[1134] = -69.511897720517084;
    lats[1135] = -69.65246772227475;
    lats[1136] = -69.793037722859665;
    lats[1137] = -69.933607722247146;
    lats[1138] = -70.074177720411782;
    lats[1139] = -70.214747717327526;
    lats[1140] = -70.355317712967462;
    lats[1141] = -70.495887707304007;
    lats[1142] = -70.636457700308753;
    lats[1143] = -70.777027691952398;
    lats[1144] = -70.917597682204899;
    lats[1145] = -71.058167671035164;
    lats[1146] = -71.198737658411332;
    lats[1147] = -71.339307644300462;
    lats[1148] = -71.47987762866866;
    lats[1149] = -71.620447611481026;
    lats[1150] = -71.761017592701492;
    lats[1151] = -71.901587572292982;
    lats[1152] = -72.042157550217183;
    lats[1153] = -72.182727526434604;
    lats[1154] = -72.323297500904502;
    lats[1155] = -72.463867473584784;
    lats[1156] = -72.604437444432065;
    lats[1157] = -72.745007413401481;
    lats[1158] = -72.885577380446747;
    lats[1159] = -73.026147345520002;
    lats[1160] = -73.166717308571819;
    lats[1161] = -73.307287269551111;
    lats[1162] = -73.447857228405013;
    lats[1163] = -73.588427185078871;
    lats[1164] = -73.728997139516167;
    lats[1165] = -73.869567091658411;
    lats[1166] = -74.010137041445006;
    lats[1167] = -74.150706988813226;
    lats[1168] = -74.291276933698185;
    lats[1169] = -74.431846876032495;
    lats[1170] = -74.57241681574645;
    lats[1171] = -74.712986752767719;
    lats[1172] = -74.853556687021296;
    lats[1173] = -74.994126618429377;
    lats[1174] = -75.134696546911186;
    lats[1175] = -75.275266472382896;
    lats[1176] = -75.41583639475742;
    lats[1177] = -75.556406313944308;
    lats[1178] = -75.69697622984954;
    lats[1179] = -75.837546142375359;
    lats[1180] = -75.978116051420102;
    lats[1181] = -76.118685956877997;
    lats[1182] = -76.259255858638895;
    lats[1183] = -76.399825756588143;
    lats[1184] = -76.540395650606285;
    lats[1185] = -76.680965540568806;
    lats[1186] = -76.821535426345932;
    lats[1187] = -76.962105307802219;
    lats[1188] = -77.102675184796354;
    lats[1189] = -77.243245057180829;
    lats[1190] = -77.383814924801513;
    lats[1191] = -77.524384787497311;
    lats[1192] = -77.664954645099883;
    lats[1193] = -77.805524497433041;
    lats[1194] = -77.946094344312371;
    lats[1195] = -78.086664185544819;
    lats[1196] = -78.227234020928066;
    lats[1197] = -78.367803850250056;
    lats[1198] = -78.508373673288318;
    lats[1199] = -78.648943489809355;
    lats[1200] = -78.789513299567957;
    lats[1201] = -78.930083102306568;
    lats[1202] = -79.070652897754229;
    lats[1203] = -79.211222685625927;
    lats[1204] = -79.351792465621628;
    lats[1205] = -79.492362237425226;
    lats[1206] = -79.632932000703448;
    lats[1207] = -79.773501755104689;
    lats[1208] = -79.914071500257819;
    lats[1209] = -80.054641235770603;
    lats[1210] = -80.195210961228469;
    lats[1211] = -80.335780676192584;
    lats[1212] = -80.47635038019834;
    lats[1213] = -80.616920072753146;
    lats[1214] = -80.757489753334553;
    lats[1215] = -80.898059421387785;
    lats[1216] = -81.038629076323318;
    lats[1217] = -81.179198717514012;
    lats[1218] = -81.319768344292086;
    lats[1219] = -81.460337955945846;
    lats[1220] = -81.600907551715878;
    lats[1221] = -81.741477130791196;
    lats[1222] = -81.882046692304485;
    lats[1223] = -82.022616235327504;
    lats[1224] = -82.163185758865239;
    lats[1225] = -82.303755261850071;
    lats[1226] = -82.444324743134914;
    lats[1227] = -82.584894201485696;
    lats[1228] = -82.725463635573107;
    lats[1229] = -82.866033043962815;
    lats[1230] = -83.006602425105484;
    lats[1231] = -83.147171777324388;
    lats[1232] = -83.287741098802584;
    lats[1233] = -83.428310387567549;
    lats[1234] = -83.568879641474325;
    lats[1235] = -83.709448858186462;
    lats[1236] = -83.850018035153667;
    lats[1237] = -83.990587169587158;
    lats[1238] = -84.131156258431133;
    lats[1239] = -84.271725298329656;
    lats[1240] = -84.412294285589354;
    lats[1241] = -84.552863216135577;
    lats[1242] = -84.693432085462035;
    lats[1243] = -84.834000888572191;
    lats[1244] = -84.974569619910426;
    lats[1245] = -85.115138273281829;
    lats[1246] = -85.255706841757572;
    lats[1247] = -85.396275317562669;
    lats[1248] = -85.536843691942948;
    lats[1249] = -85.677411955006008;
    lats[1250] = -85.817980095529578;
    lats[1251] = -85.958548100730781;
    lats[1252] = -86.0991159559849;
    lats[1253] = -86.239683644481104;
    lats[1254] = -86.380251146798656;
    lats[1255] = -86.520818440379529;
    lats[1256] = -86.661385498868242;
    lats[1257] = -86.801952291278369;
    lats[1258] = -86.942518780928566;
    lats[1259] = -87.083084924070917;
    lats[1260] = -87.223650668104085;
    lats[1261] = -87.364215949214667;
    lats[1262] = -87.504780689222315;
    lats[1263] = -87.645344791295628;
    lats[1264] = -87.785908134040668;
    lats[1265] = -87.926470563186442;
    lats[1266] = -88.067031879650926;
    lats[1267] = -88.207591822004105;
    lats[1268] = -88.348150039999084;
    lats[1269] = -88.488706053376362;
    lats[1270] = -88.629259185411627;
    lats[1271] = -88.76980845110036;
    lats[1272] = -88.91035235926023;
    lats[1273] = -89.050888539966436;
    lats[1274] = -89.191412986832432;
    lats[1275] = -89.331918354381827;
    lats[1276] = -89.472389582061126;
    lats[1277] = -89.612790258599077;
    lats[1278] = -89.753004943174034;
    lats[1279] = -89.892396445590066;
    return GRIB_SUCCESS;
}

/* 'trunc' is the Gaussian number (or order) */
/* i.e. Number of parallels between a pole and the equator */
static int _grib_get_gaussian_latitudes(long trunc, double* lats)
{
    long jlat, iter, legi;
    double rad2deg, convval, root, legfonc = 0;
    double mem1, mem2, conv;
    double denom     = 0.0;
    double precision = 1.0E-14;
    long nlat        = trunc * 2;

    rad2deg = 180.0 / M_PI;

    convval = (1.0 - ((2.0 / M_PI) * (2.0 / M_PI)) * 0.25);

    gauss_first_guess(trunc, lats);
    denom = sqrt(((((double)nlat) + 0.5) * (((double)nlat) + 0.5)) + convval);

    for (jlat = 0; jlat < trunc; jlat++) {
        /*   First approximation for root      */
        root = cos(lats[jlat] / denom);

        /*   Perform loop of Newton iterations  */
        iter = 0;
        conv = 1;

        while (fabs(conv) >= precision) {
            mem2 = 1.0;
            mem1 = root;

            /*  Compute Legendre polynomial  */
            for (legi = 0; legi < nlat; legi++) {
                legfonc = ((2.0 * (legi + 1) - 1.0) * root * mem1 - legi * mem2) / ((double)(legi + 1));
                mem2    = mem1;
                mem1    = legfonc;
            }

            /*  Perform Newton iteration  */
            conv = legfonc / ((((double)nlat) * (mem2 - root * legfonc)) / (1.0 - (root * root)));
            root -= conv;

            /*  Routine fails if no convergence after MAXITER iterations  */
            if (iter++ > MAXITER) {
                return GRIB_GEOCALCULUS_PROBLEM;
            }
        }

        /*   Set North and South values using symmetry */
        lats[jlat]            = asin(root) * rad2deg;
        lats[nlat - 1 - jlat] = -lats[jlat];
    }

    if (nlat != (trunc * 2))
        lats[trunc + 1] = 0.0;
    return GRIB_SUCCESS;
}

int grib_get_gaussian_latitudes(long trunc, double* lats)
{
    if (trunc == 640)
        return get_precomputed_latitudes_N640(lats);
    else
        return _grib_get_gaussian_latitudes(trunc, lats);
}

/* Boolean return type: 1 if the reduced gaussian field is global, 0 for sub area */
int is_gaussian_global(
    double lat1, double lat2, double lon1, double lon2, /* bounding box*/
    long num_points_equator,                            /* num points on latitude at equator */
    const double* latitudes,                            /* array of Gaussian latitudes (size 2*N) */
    double angular_precision                            /* tolerance for angle comparison */
)
{
    int global         = 1;
    const double d     = fabs(latitudes[0] - latitudes[1]);
    const double delta = 360.0 / num_points_equator;
    /* Compute the expected last longitude for a global field */
    const double lon2_global = 360.0 - delta;
    /* Compute difference between expected longitude and actual one */
    const double lon2_diff = fabs(lon2 - lon2_global) - delta;

    /*
    {
        grib_context* c=grib_context_get_default();
        if (c->debug) {
            fprintf(stderr,"ECCODES DEBUG is_gaussian_global: lat1=%f, lat2=%f, glat0=%f, d=%f\n", lat1, lat2, latitudes[0], d);
            fprintf(stderr,"ECCODES DEBUG is_gaussian_global: lon1=%f, lon2=%f, glon2=%f, delta=%f\n", lon1, lon2, lon2_global, delta);
        }
    }
    */

    /* Note: final gaussian latitude = -first latitude */
    if ((fabs(lat1 - latitudes[0]) >= d) ||
        (fabs(lat2 + latitudes[0]) >= d) ||
        lon1 != 0 ||
        lon2_diff > angular_precision) {
        global = 0; /* sub area */
    }
    return global;
}

/* From Magics GribRotatedInterpretor::rotate */
void rotate(const double inlat, const double inlon,
            const double angleOfRot, const double southPoleLat, const double southPoleLon,
            double* outlat, double* outlon)
{
    double PYROT, PXROT, ZCYROT, ZCXROT, ZSXROT;
    const double ZSYCEN = sin(DEG2RAD * (southPoleLat + 90.));
    const double ZCYCEN = cos(DEG2RAD * (southPoleLat + 90.));
    const double ZXMXC  = DEG2RAD * (inlon - southPoleLon);
    const double ZSXMXC = sin(ZXMXC);
    const double ZCXMXC = cos(ZXMXC);
    const double ZSYREG = sin(DEG2RAD * inlat);
    const double ZCYREG = cos(DEG2RAD * inlat);
    double ZSYROT       = ZCYCEN * ZSYREG - ZSYCEN * ZCYREG * ZCXMXC;

    ZSYROT = MAX(MIN(ZSYROT, +1.0), -1.0);

    PYROT = asin(ZSYROT) * RAD2DEG;

    ZCYROT = cos(PYROT * DEG2RAD);
    ZCXROT = (ZCYCEN * ZCYREG * ZCXMXC + ZSYCEN * ZSYREG) / ZCYROT;
    ZCXROT = MAX(MIN(ZCXROT, +1.0), -1.0);
    ZSXROT = ZCYREG * ZSXMXC / ZCYROT;

    PXROT = acos(ZCXROT) * RAD2DEG;

    if (ZSXROT < 0.0)
        PXROT = -PXROT;

    *outlat = PYROT;
    *outlon = PXROT;
}

/* From old ecKit RotateGrid::unrotate (Tag 2015.11.0) */
void unrotate(const double inlat, const double inlon,
              const double angleOfRot, const double southPoleLat, const double southPoleLon,
              double* outlat, double* outlon)
{
    const double lon_x = inlon;
    const double lat_y = inlat;
    /* First convert the data point from spherical lat lon to (x',y',z') */
    double latr = lat_y * DEG2RAD;
    double lonr = lon_x * DEG2RAD;
    double xd   = cos(lonr) * cos(latr);
    double yd   = sin(lonr) * cos(latr);
    double zd   = sin(latr);

    double t = -(90.0 + southPoleLat);
    double o = -southPoleLon;

    double sin_t = sin(DEG2RAD * t);
    double cos_t = cos(DEG2RAD * t);
    double sin_o = sin(DEG2RAD * o);
    double cos_o = cos(DEG2RAD * o);

    double x = cos_t * cos_o * xd + sin_o * yd + sin_t * cos_o * zd;
    double y = -cos_t * sin_o * xd + cos_o * yd - sin_t * sin_o * zd;
    double z = -sin_t * xd + cos_t * zd;

    double ret_lat = 0, ret_lon = 0;

    /* Then convert back to 'normal' (lat,lon)
     * Uses arcsin, to convert back to degrees, put in range -1 to 1 in case of slight rounding error
     * avoid error on calculating e.g. asin(1.00000001) */
    if (z > 1.0)
        z = 1.0;
    if (z < -1.0)
        z = -1.0;

    ret_lat = asin(z) * RAD2DEG;
    ret_lon = atan2(y, x) * RAD2DEG;

    /* Still get a very small rounding error, round to 6 decimal places */
    ret_lat = roundf(ret_lat * 1000000.0) / 1000000.0;
    ret_lon = roundf(ret_lon * 1000000.0) / 1000000.0;

    ret_lon -= angleOfRot;

    /* Make sure ret_lon is in range*/
    /*
    while (ret_lon < lonmin_) ret_lon += 360.0;
    while (ret_lon >= lonmax_) ret_lon -= 360.0;
     */
    *outlat = ret_lat;
    *outlon = ret_lon;
}
